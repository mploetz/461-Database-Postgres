CREATE FUNCTION
CREATE FUNCTION
CREATE FUNCTION
CREATE FUNCTION
CREATE VIEW
 sid  |                        books                        
------+-----------------------------------------------------
 1001 | {2002,2007,2009,2011,2013}
 1002 | {2001,2002,2007,2011,2012,2013}
 1003 | {2002,2007,2011,2012,2013}
 1004 | {2006,2007,2008,2011,2012,2013}
 1005 | {2007,2011,2012,2013}
 1006 | {2006,2007,2008,2011,2012,2013}
 1007 | {2001,2002,2003,2007,2008,2009,2010,2011,2012,2013}
 1008 | {2007,2011,2012,2013}
 1009 | {2001,2002,2011,2012,2013}
 1010 | {2001,2002,2003,2011,2012,2013}
 1011 | {2002,2011,2012}
 1012 | {2011,2012}
 1013 | {2001,2011,2012}
 1014 | {2008,2011,2012}
 1015 | {}
 1016 | {}
 1017 | {2001,2002,2003,2008,2012}
 1020 | {2001,2012}
 1021 | {}
 1022 | {2014}
 1023 | {2012,2014}
 1040 | {2002}
(22 rows)

CREATE VIEW
 bookno |                                     students                                      
--------+-----------------------------------------------------------------------------------
   2001 | {1002,1007,1009,1010,1013,1017,1020}
   2002 | {1001,1002,1003,1007,1009,1010,1011,1017,1040}
   2003 | {1007,1010,1017}
   2004 | {}
   2005 | {}
   2006 | {1004,1006}
   2007 | {1001,1002,1003,1004,1005,1006,1007,1008}
   2008 | {1004,1006,1007,1014,1017}
   2009 | {1001,1007}
   2010 | {1007}
   2011 | {1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1011,1012,1013,1014}
   2012 | {1002,1003,1004,1005,1006,1007,1008,1009,1010,1011,1012,1013,1014,1017,1020,1023}
   2013 | {1001,1002,1003,1004,1005,1006,1007,1008,1009,1010}
   2014 | {1022,1023}
(14 rows)

CREATE VIEW
 bookno |                          citedbooks                           
--------+---------------------------------------------------------------
   2001 | {2002,2007}
   2002 | {2003}
   2003 | {2001,2002,2004}
   2004 | {}
   2005 | {}
   2006 | {}
   2007 | {}
   2008 | {2011,2012}
   2009 | {}
   2010 | {2001,2002,2003,2004,2005,2006,2007,2008,2009,2011,2013,2014}
   2011 | {}
   2012 | {2001}
   2013 | {}
   2014 | {}
(14 rows)

CREATE VIEW
 bookno |   citingbooks    
--------+------------------
   2001 | {2003,2010,2012}
   2002 | {2001,2003,2010}
   2003 | {2002,2010}
   2004 | {2003,2010}
   2005 | {2010}
   2006 | {2010}
   2007 | {2001,2010}
   2008 | {2010}
   2009 | {2010}
   2010 | {}
   2011 | {2008,2010}
   2012 | {2008}
   2013 | {2010}
   2014 | {2010}
(14 rows)

CREATE VIEW
    major     |                 students                  
--------------+-------------------------------------------
 Anthropology | {1017}
 Biology      | {1009,1010}
 CS           | {1002,1004,1006,1007,1011,1012,1013,1022}
 Chemistry    | {1015}
 Math         | {1001,1002,1003,1011}
 Physics      | {1001,1007,1008}
 Psychology   | {1013}
 Theater      | {1014}
(8 rows)

CREATE VIEW
 sid  |     majors      
------+-----------------
 1001 | {Math,Physics}
 1002 | {CS,Math}
 1003 | {Math}
 1004 | {CS}
 1005 | {}
 1006 | {CS}
 1007 | {CS,Physics}
 1008 | {Physics}
 1009 | {Biology}
 1010 | {Biology}
 1011 | {CS,Math}
 1012 | {CS}
 1013 | {CS,Psychology}
 1014 | {Theater}
 1015 | {Chemistry}
 1016 | {}
 1017 | {Anthropology}
 1020 | {}
 1021 | {}
 1022 | {CS}
 1023 | {}
 1040 | {}
(22 rows)

     
-------------
 Problem 3.a
(1 row)

 bookno 
--------
   2001
   2002
   2003
   2004
   2007
(5 rows)

     
-------------
 Problem 3.b
(1 row)

 bookno |        title         
--------+----------------------
   2001 | Databases
   2002 | OperatingSystems
   2007 | ProgrammingLanguages
   2012 | Geometry
   2013 | RealAnalysis
   2011 | Anthropology
(6 rows)

     
-------------
 Problem 3.c
(1 row)

 bookno 
--------
   2005
   2006
   2008
   2009
   2012
   2013
   2014
(7 rows)

     
-------------
 Problem 3.d
(1 row)

 sid  
------
 1023
(1 row)

     
-------------
 Problem 3.e
(1 row)

 sid  
------
 1001
 1015
 1016
 1021
 1040
(5 rows)

     
-------------
 Problem 3.f
(1 row)

 sid  
------
 1015
 1016
 1021
 1022
 1023
(5 rows)

     
-------------
 Problem 3.g
(1 row)

 sid  | sname 
------+-------
 1011 | Nick
 1013 | Lisa
 1020 | Ahmed
 1040 | Sofie
(4 rows)

     
-------------
 Problem 3.h
(1 row)

 bookno 
--------
   2004
   2005
(2 rows)

     
-------------
 Problem 3.i
(1 row)

 bookno 
--------
   2004
   2005
   2006
   2007
   2009
   2010
   2011
   2013
   2014
(9 rows)

     
-------------
 Problem 3.j
(1 row)

 sid  | bookno 
------+--------
 1001 |   2001
 1001 |   2002
 1001 |   2003
 1001 |   2004
 1001 |   2005
 1001 |   2006
 1001 |   2007
 1001 |   2008
 1001 |   2009
 1001 |   2010
 1001 |   2011
 1001 |   2012
 1001 |   2013
 1001 |   2014
 1002 |   2001
 1002 |   2002
 1002 |   2003
 1002 |   2004
 1002 |   2005
 1002 |   2006
 1002 |   2007
 1002 |   2008
 1002 |   2009
 1002 |   2010
 1002 |   2011
 1002 |   2012
 1002 |   2013
 1002 |   2014
 1003 |   2001
 1003 |   2002
 1003 |   2003
 1003 |   2004
 1003 |   2005
 1003 |   2006
 1003 |   2007
 1003 |   2008
 1003 |   2009
 1003 |   2010
 1003 |   2011
 1003 |   2012
 1003 |   2013
 1003 |   2014
 1004 |   2001
 1004 |   2002
 1004 |   2003
 1004 |   2004
 1004 |   2005
 1004 |   2006
 1004 |   2007
 1004 |   2008
 1004 |   2009
 1004 |   2010
 1004 |   2011
 1004 |   2012
 1004 |   2013
 1004 |   2014
 1005 |   2001
 1005 |   2002
 1005 |   2003
 1005 |   2004
 1005 |   2005
 1005 |   2006
 1005 |   2007
 1005 |   2008
 1005 |   2009
 1005 |   2010
 1005 |   2011
 1005 |   2012
 1005 |   2013
 1005 |   2014
 1006 |   2001
 1006 |   2002
 1006 |   2003
 1006 |   2004
 1006 |   2005
 1006 |   2006
 1006 |   2007
 1006 |   2008
 1006 |   2009
 1006 |   2010
 1006 |   2011
 1006 |   2012
 1006 |   2013
 1006 |   2014
 1007 |   2001
 1007 |   2002
 1007 |   2003
 1007 |   2004
 1007 |   2005
 1007 |   2006
 1007 |   2007
 1007 |   2008
 1007 |   2009
 1007 |   2010
 1007 |   2011
 1007 |   2012
 1007 |   2013
 1007 |   2014
 1008 |   2001
 1008 |   2002
 1008 |   2003
 1008 |   2004
 1008 |   2005
 1008 |   2006
 1008 |   2007
 1008 |   2008
 1008 |   2009
 1008 |   2010
 1008 |   2011
 1008 |   2012
 1008 |   2013
 1008 |   2014
 1009 |   2001
 1009 |   2002
 1009 |   2003
 1009 |   2004
 1009 |   2005
 1009 |   2006
 1009 |   2007
 1009 |   2008
 1009 |   2009
 1009 |   2010
 1009 |   2011
 1009 |   2012
 1009 |   2013
 1009 |   2014
 1010 |   2001
 1010 |   2002
 1010 |   2003
 1010 |   2004
 1010 |   2005
 1010 |   2006
 1010 |   2007
 1010 |   2008
 1010 |   2009
 1010 |   2010
 1010 |   2011
 1010 |   2012
 1010 |   2013
 1010 |   2014
 1011 |   2001
 1011 |   2002
 1011 |   2003
 1011 |   2004
 1011 |   2005
 1011 |   2006
 1011 |   2007
 1011 |   2008
 1011 |   2009
 1011 |   2010
 1011 |   2011
 1011 |   2012
 1011 |   2013
 1011 |   2014
 1012 |   2001
 1012 |   2002
 1012 |   2003
 1012 |   2004
 1012 |   2005
 1012 |   2006
 1012 |   2007
 1012 |   2008
 1012 |   2009
 1012 |   2010
 1012 |   2011
 1012 |   2012
 1012 |   2013
 1012 |   2014
 1013 |   2001
 1013 |   2002
 1013 |   2003
 1013 |   2004
 1013 |   2005
 1013 |   2006
 1013 |   2007
 1013 |   2008
 1013 |   2009
 1013 |   2010
 1013 |   2011
 1013 |   2012
 1013 |   2013
 1013 |   2014
 1014 |   2001
 1014 |   2002
 1014 |   2003
 1014 |   2004
 1014 |   2005
 1014 |   2006
 1014 |   2007
 1014 |   2008
 1014 |   2009
 1014 |   2010
 1014 |   2011
 1014 |   2012
 1014 |   2013
 1014 |   2014
 1017 |   2001
 1017 |   2002
 1017 |   2003
 1017 |   2004
 1017 |   2005
 1017 |   2006
 1017 |   2007
 1017 |   2008
 1017 |   2009
 1017 |   2010
 1017 |   2011
 1017 |   2012
 1017 |   2013
 1017 |   2014
 1020 |   2001
 1020 |   2002
 1020 |   2003
 1020 |   2004
 1020 |   2005
 1020 |   2006
 1020 |   2007
 1020 |   2008
 1020 |   2009
 1020 |   2010
 1020 |   2011
 1020 |   2012
 1020 |   2013
 1020 |   2014
 1022 |   2001
 1022 |   2002
 1022 |   2003
 1022 |   2004
 1022 |   2005
 1022 |   2006
 1022 |   2007
 1022 |   2008
 1022 |   2009
 1022 |   2010
 1022 |   2011
 1022 |   2012
 1022 |   2013
 1022 |   2014
 1023 |   2001
 1023 |   2002
 1023 |   2003
 1023 |   2004
 1023 |   2005
 1023 |   2006
 1023 |   2007
 1023 |   2008
 1023 |   2009
 1023 |   2010
 1023 |   2011
 1023 |   2012
 1023 |   2013
 1023 |   2014
 1040 |   2001
 1040 |   2002
 1040 |   2004
 1040 |   2005
 1040 |   2006
 1040 |   2007
 1040 |   2008
 1040 |   2009
 1040 |   2010
 1040 |   2011
 1040 |   2012
 1040 |   2013
 1040 |   2014
(265 rows)

     
-------------
 Problem 3.k
(1 row)

 sid  | bookno 
------+--------
 1015 |   2001
 1015 |   2002
 1015 |   2003
 1015 |   2004
 1015 |   2005
 1015 |   2006
 1015 |   2007
 1015 |   2008
 1015 |   2009
 1015 |   2010
 1015 |   2011
 1015 |   2012
 1015 |   2013
 1015 |   2014
 1016 |   2001
 1016 |   2002
 1016 |   2003
 1016 |   2004
 1016 |   2005
 1016 |   2006
 1016 |   2007
 1016 |   2008
 1016 |   2009
 1016 |   2010
 1016 |   2011
 1016 |   2012
 1016 |   2013
 1016 |   2014
 1021 |   2001
 1021 |   2002
 1021 |   2003
 1021 |   2004
 1021 |   2005
 1021 |   2006
 1021 |   2007
 1021 |   2008
 1021 |   2009
 1021 |   2010
 1021 |   2011
 1021 |   2012
 1021 |   2013
 1021 |   2014
 1040 |   2003
(43 rows)

     
-------------
 Problem 3.l
(1 row)

 sid  | sid  
------+------
 1004 | 1006
 1005 | 1008
 1006 | 1004
 1008 | 1005
 1015 | 1016
 1015 | 1021
 1016 | 1015
 1016 | 1021
 1021 | 1015
 1021 | 1016
(10 rows)

     
-------------
 Problem 3.m
(1 row)

 sid  | sid  
------+------
 1001 | 1003
 1001 | 1009
 1001 | 1017
 1002 | 1004
 1002 | 1006
 1002 | 1010
 1003 | 1001
 1003 | 1009
 1003 | 1017
 1004 | 1002
 1004 | 1006
 1004 | 1010
 1005 | 1008
 1006 | 1002
 1006 | 1004
 1006 | 1010
 1008 | 1005
 1009 | 1001
 1009 | 1003
 1009 | 1017
 1010 | 1002
 1010 | 1004
 1010 | 1006
 1011 | 1013
 1011 | 1014
 1012 | 1020
 1012 | 1023
 1013 | 1011
 1013 | 1014
 1014 | 1011
 1014 | 1013
 1015 | 1016
 1015 | 1021
 1016 | 1015
 1016 | 1021
 1017 | 1001
 1017 | 1003
 1017 | 1009
 1020 | 1012
 1020 | 1023
 1021 | 1015
 1021 | 1016
 1022 | 1040
 1023 | 1012
 1023 | 1020
 1040 | 1022
(46 rows)

     
-------------
 Problem 3.n
(1 row)

 bookno 
--------
   2010
(1 row)

